<!DOCTYPE html>
<html>

<head>
  <title>Simple click event</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
  <style>
  /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */

  #map {
    height: 700px;
    width: auto;
  }
  /* Optional: Makes the sample page fill the window. */

  </style>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <h2>Search!!!</h2>
        <button id="geolocation">Get Geo</button>
      </div>
      <div id="map">
      </div>
    </div>
  </div>
  <script>
  // Note: This example requires that you consent to location sharing when
  // prompted by your browser. If you see the error "The Geolocation service
  // failed.", it means you probably did not give permission for the browser to
  // locate you.

  function initMap() {
  var map, infoWindow, marker;
  let markerArr;
    var options = {
      start: {
        center: { lat: -34.397, lng: 150.644 },
        zoom: 6
      }
    };
    var infoWindow = new google.maps.InfoWindow


    // creating a map
    map = new google.maps.Map(document.getElementById('map'), options.start);

    google.maps.event.addListener(map, 'click', function(event) {
      var latLng = event.latLng
      addMarker({ coords: latLng });
      console.log("lat: "+ latLng.lat() +",lng: "+ latLng.lng());
      console.log(event)
    });

    function addSample() {
    let markerArr = [{
        coords: { lat: -37.8136, lng: 144.9631 },
        content: "Melbourne"
      },
      {
        coords: { lat: -41.2865, lng: 174.7762 },
        content: "Wellington"
      }]
    }
    ;
    // marker
    // var marker =  new google.maps.Marker({
    //   position:{lat:33.8688, lng:151.2093},
    //   map:map,
    // })
    // Try HTML5 geolocation.
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        var pos = {
          lat: position.coords.latitude,
          lng: position.coords.longitude
        };

        infoWindow.setPosition(pos);
        infoWindow.setContent('Location found.');
        infoWindow.open(map);
        map.setCenter(pos);
      }, function() {
        handleLocationError(true, infoWindow, map.getCenter());
      });
    } else {
      // Browser doesn't support Geolocation
      handleLocationError(false, infoWindow, map.getCenter());
    }

    function addMarker(props) {
      var marker = new google.maps.Marker({
        position: props.coords,
        map: map,
      });
      // check for new icons
      if (props.iconImage) {
        // set icon image
        marker.setIcon(props.iconImage)
      }
      if (props.content) {
        var infoWindow = new google.maps.InfoWindow({
          content: props.content
        })
      }
      marker.addListener('click', function() {
        infoWindow.open(map, marker)
      });
    }

    for (i = 0; i < markerArr.length; i++) {
      addMarker(markerArr[i]);
    }

    // addMarker({
    //   coords: { lat: -37.8136, lng: 144.9631 },
    //   content: "Melbourne"
    // });

    function handleLocationError(browserHasGeolocation, infoWindow, pos) {
      infoWindow.setPosition(pos);
      infoWindow.setContent(browserHasGeolocation ?
        'Error: The Geolocation service failed.' :
        'Error: Your browser doesn\'t support geolocation.');
      infoWindow.open(map);
    }


  };




  // $('#geolocation').on('click', function() {

  // })

  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1Uqd8fvNhgRklbA6UVIr5Mmf23Ns0aGA&callback=initMap">


  </script>
</body>

</html>
